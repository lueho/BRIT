# Task: Bootstrap 4 to 5 Migration

## Checklist
- [x] Audit Bootstrap 4 class usage in markup templates
  - Located in templates:
    - `brit/templates/partials/_footer.html`: `col-md-4 mb-4 mb-md-0` (Ã—2)
    - `brit/templates/learning.html`: `col col-12 col-md-6 mb-4`, `col col-12 col-md-6 col-lg-3 mb-4`
    - `brit/templates/home.html`: `col col-12 col-md-6 mb-4`, `col-12 col-lg-7 col-xl-6 order-2 order-lg-1`, `col-12 col-lg-7 col-xl-6 order-1 order-lg-2`, `col col-12 col-md-6 col-lg-3 mb-4`
    - `brit/templates/filtered_list.html`: `col-lg-8 order-2 order-lg-1`, `col-lg-4 order-1 order-lg-2`
    - `brit/templates/cookie_consent/cookiegroup_list.html`: `col col-12 col-md-6 col-lg-3 mt-4`
    - `brit/templates/base_single_card.html`: `card-deck  col-xs-12 col-sm-10 col-md-8 col-lg-6 col-xl-4`
- [ ] Audit Bootstrap 4 usage in dependencies
  - identified relevant depencendies:
    - `django-bootstrap-modal-forms==3.0.5`
    - `django-bootstrap4==2024.10`
    - `django-crispy-forms==2.3`
- [x] Update HTML markup for grid, utilities, and component changes
  - Files updated: base_single_card.html, filtered_list.html, partials/_topbar.html, simple_list_card.html, simple_detail_card.html, cookie_consent/_cookie_group.html
- [x] Update SCSS imports to Bootstrap 5 and adjust custom overrides
  - Files updated: static/scss/brit-theme.scss (likely renamed from sb-admin-2.scss)
- [x] Remove sb-admin-2/Bootstrap 4 CSS and SCSS imports ([x] `sb-admin-2.min.js` removed from `base_iframe.html`, [x] SCSS imports in `brit-theme.scss` updated to BS5)
- [ ] Update JS initialization for Bootstrap 5 plugins (Popper, dropdowns, modals)
- [-] Test UI components and layouts across breakpoints - Many referenced SCSS files for specific reviews (e.g., _dropdowns, _border, _text, _containers, _topbar, _sidebar) were not found. General UI testing should still be performed.
  - [ ] Specifically review custom dropdown styling in `_dropdowns.scss` for redundancy against Bootstrap 5 defaults and variables. - `_dropdowns.scss` not found.
  - [ ] Review custom border utilities in `utilities/_border.scss` (e.g., `.border-left-primary`) for usage frequency, consistency with BS5 border width scale, and the necessity of `!important`. - `utilities/_border.scss` not found.
  - [ ] Review custom text size utilities `.text-xs` and `.text-lg` in `utilities/_text.scss` for potential integration into Bootstrap's `$font-sizes` map. - `utilities/_text.scss` not found.
  - [X] During UI/accessibility testing, review the `a:focus { outline: none; }` style in `_global.scss` to ensure it doesn't negatively impact accessibility or Bootstrap's intended focus indicators. - Style not found in `_global.scss` or other SCSS files.
  - [ ] Long-term: Consider refactoring the `#wrapper`/`#content-wrapper` layout structure from `_global.scss` as part of phasing out sb-admin-2 theme remnants. - `#wrapper` and `#content-wrapper` styles not found in current SCSS files.
  - [ ] Test layouts thoroughly, especially on smaller screens, after changes to `_containers.scss` (custom padding/gutters commented out). Adopt Bootstrap 5 responsive gutter utilities (e.g., `.g-1`, `.gx-sm-2`) where specific gutter widths are needed, instead of global overrides. - `_containers.scss` not found.
  - [ ] Review `.badge-counter` styling in `navs/_global.scss`; consider if Bootstrap 5 positioning utilities could simplify its implementation while retaining the desired appearance (especially the `transform: scale(0.7)`). - `.badge-counter` styles not found in `navs/_global.scss` or other SCSS files.
  - [X] In HTML templates, ensure instances of `.navbar-nav.ml-auto` within the topbar are updated to `.navbar-nav.ms-auto` to align with Bootstrap 5 and the updated `navs/_topbar.scss` styles. - Confirmed by grep.
  - [ ] During UI/accessibility testing, review `outline: none` styles for `.nav-item:focus` and `.nav-link:focus` in `navs/_topbar.scss`. - `navs/_topbar.scss` not found.
  - [X] In HTML templates, ensure sidebar accordion elements update `data-toggle="collapse"` to `data-bs-toggle="collapse"` to match changes in `navs/_sidebar.scss`. - Confirmed by grep.
  - [ ] During UI/accessibility testing, review `outline: none` style for `#sidebarToggle:focus` in `navs/_sidebar.scss`. - `navs/_sidebar.scss` not found.
  - [X] Scan templates for `data-bs-toggle="tooltip"` or `data-bs-toggle="popover"`. If found, ensure they are initialized in JavaScript (e.g., in `sb-admin-2.js` or a dedicated script snippet), as Bootstrap 5 requires manual initialization for these components. - No instances found.
  - [!] **Missing File**: `jquery.bootstrap.modal.forms.js` (referenced in `base.html` via `{% static 'js/jquery.bootstrap.modal.forms.js' %}`) was not found in `brit/static/js/`. Investigate its source (Django app? Manual file?) and restore it.
  - [X] ~~Missing File~~: `jquery.bootstrap.modal.forms.js` is from `django-bootstrap-modal-forms`. For BS5, use `bootstrap5.modal.forms.min.js`.
  - [X] Updated `base.html` and `base_iframe.html` to load `{% static 'js/bootstrap5.modal.forms.min.js' %}`.
  - [X] **Locate and update `django-bootstrap-modal-forms` JavaScript initialization calls** from the BS4 jQuery style (`$('#el').modalForm(...)`) to the BS5 vanilla JS style (`modalForm(document.getElementById('el'), ...)`). Updated inline script in `base.html`.
- [X] Update documentation referencing Bootstrap 4 in docs/ - Updated style_guide.md, guidelines.md, architecture.md.
- [X] Run tests and fix any regressions - All tests passed.
- [x] Update `bootstrap.bundle.min.js` in `base.html` from v5.1.3 to v5.3.2 (to match CSS and `base_iframe.html`)
- [x] Clean up obsolete Bootstrap 4 code and assets
  - [x] `sb-admin-2.min.css` removed from `brit-theme.scss` imports
  - [x] `sb-admin-2.min.js` removed from `base_iframe.html`

- [X] Address remaining Bootstrap 4 class usage:
  - [X] `card-deck` in `brit/templates/about.html` and `brit/templates/privacy_policy.html` - Replaced with BS5 grid (row, col, g-*, h-100).
  - [X] `mr-3` -> `me-3` in `processes/templates/processes/mock_type_detail.html`
  - [X] All `mr-*` classes replaced with `me-*` in HTML templates.
  - [x] `.custom-checkbox` in `brit/static/scss/components/_sliders.scss` (updated to `.form-check`)
  - [x] `form-row` in `utils/templates/widgets/nullable_range_slider.html` (updated to `row g-3`)
  - [x] `form-row` in `utils/templates/bootstrap5/dynamic_table_inline_formset.html` (and associated JS in `materials/templates/materials/composition_form.html`) - `.form-row` not present; `formset-form-row` used on `<tr>` and JS handles it correctly.
  - [X] Replace `ml-*` with `ms-*` (margin start), including `ml-auto` to `ms-auto` - All instances updated.
  - [X] Replace `pr-*` with `pe-*` (padding end) - No instances found.
  - [X] Replace `pl-*` with `ps-*` (padding start) - No instances found.
  - [X] Replace `text-left` with `text-start` - All instances updated.
  - [X] Replace `text-right` with `text-end` - No instances found.
  - [X] Replace `font-weight-bold` with `fw-bold` - 1 instance updated in `greenhouse_detail.html`.
  - [X] Replace `font-weight-light` with `fw-light` - No instances found.
  - [X] Replace `font-italic` with `fst-italic` - 1 instance updated in `nullable_range_slider.html`.
  - [X] Replace `float-left` with `float-start` - All instances updated.
  - [X] Replace `float-right` with `float-end` - All instances updated.
  - [X] Replace `data-toggle` with `data-bs-toggle` for all components (dropdowns, collapse, tabs, etc.) - All instances updated.
  - [X] Replace `data-target` with `data-bs-target` for collapse components. - All instances updated.
  - [X] Replace `btn-block` with `w-100` (for standard buttons) or removed (for dropdown items) in `users/templates/user_profile.html`, `users/templates/registration/*`, `case_studies/soilcom/templates/soilcom/collection_detail.html`, and `case_studies/soilcom/templates/soilcom/collection_filter.html`.
  - [X] Replace `no-gutters` with Bootstrap 5 gutter classes (e.g., `g-0`, `gx-0`, `gy-0`) - No instances found.

## Final Testing and Cleanup
- [ ] Thorough UI and accessibility testing across breakpoints
  - [ ] Focus on custom styles and overrides to ensure they integrate well with Bootstrap 5.
- [ ] Address lint errors and code quality issues (separate phase if extensive)
  - [!] Lint error H019 in `greenhouse_detail.html` (`javascript:abc()`) - Acknowledge, defer to dedicated cleanup phase.
- [-] Review and remove any remaining Bootstrap 4-specific SCSS variables or mixins if they were not caught during the main migration. - Custom variable files (`_colors.scss`, `_navigation.scss`, `_spacing.scss`) reviewed; no obvious BS4-specific remnants found. Broader mixin review in all component SCSS deferred unless specific issues arise.
- [x] Document any new custom design patterns or significant SCSS architectural decisions in `docs/style_guide.md` or `docs/architecture.md` (as per `MEMORY[user_global]` and `MEMORY[c0c8f7af-c914-4bce-8148-2945eeb4820e]`). - Added SCSS architecture details to `docs/02_developer_guide/architecture.md`.
- [ ] Final pass: `pre-commit run --all-files`
- [ ] Create PR for review.

## Context
- Current: project uses Bootstrap 4 and sb-admin-2 theme
- Goal: migrate fully to Bootstrap 5 and custom design system
- SCSS modules and Live Sass Compiler in use; no npm or Node.js
