{% extends 'simple_form_card.html' %}

{% block javascript %}

    <script type="text/javascript">

        function data_url(element) {
            if (element['dataUrl']) {
                return element['dataUrl'];
            } else {
                return element.data('form').replace('__pk__', "{{ object.pk }}");
            }
        }

        function updateCollectionModalForm() {
            $(".modal-link").each(function () {
                $(this).modalForm({
                    formURL: $(this).data('href'),
                    errorClass: ".is-invalid",
                    asyncUpdate: true,
                    asyncSettings: {
                        closeOnSubmit: true,
                        successMessage: '<div class="success d-none">Success</div>',
                        dataUrl: data_url($(this)),
                        dataElementId: '#form-container',
                        dataKey: 'form',
                        addModalFormFunction: updateCollectionModalForm
                    }
                })
            });
        }

        $(document).ready(function () {
            $("#sidebarToggle").click();
            updateCollectionModalForm();
        });

    </script>

{% endblock javascript %}