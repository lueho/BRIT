"use strict";const fieldConfig={name:{include:!0,format:e=>e||""},description:{include:!0,format:e=>e||""}};function featureClickHandler(e,t){resetFeatureStyles(t);const n=new Map;if(t.eachLayer((t=>{if(t instanceof L.Polygon){const o=t.toGeoJSON(),r=[e.latlng.lng,e.latlng.lat];if(turf.inside(r,o)){const e=t.feature.properties.region;n.has(e)||n.set(e,[]),n.get(e).push(t)}}})),window.intersectingFeatures=n,window.featureGroup=t,1===n.size){const[e]=n.keys(),t=n.get(e)[0];selectFeature(t),fetchFeaturesLayerSummary({id:t.feature.id})}else{n.forEach((e=>{e.forEach((e=>selectFeature(e)))}));let t="";n.forEach(((e,n)=>{t+=`<strong>${n}</strong><br/>`,t+=e.map(((e,t)=>{const o=e.feature.id,r=e.feature.properties.name;return`<a href="javascript:void(0)" onclick="handleShowcaseClick(${o}, '${n}', ${t})">${r}</a><br>`})).join(""),t+="<br>"})),t=t.replace(/<br>$/,""),""===t&&(t="No features found"),map.openPopup(t.trim(),e.latlng,{offset:L.point(0,-24)})}}async function handleShowcaseClick(e,t,n){resetFeatureStyles(window.featureGroup);const o=window.intersectingFeatures.get(t)[n];selectFeature(o),fetchFeaturesLayerSummary({id:o.feature.id}),map.closePopup()}function scrollToSummaries(){const e=document.getElementById("filter_result_card");e&&e.scrollIntoView({behavior:"smooth",block:"start"})}function createFeatureLayerBindings(e){e.on("click",(t=>featureClickHandler(t,e)))}function uncollapseInfoCardBody(){const e=document.getElementById("info-card-body");e&&e.classList.remove("collapse")}document.addEventListener("DOMContentLoaded",uncollapseInfoCardBody);